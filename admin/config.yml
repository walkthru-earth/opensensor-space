# OpenSensor Station Registration - Sveltia CMS Configuration
# Hosted on Netlify for OAuth - https://opensensor-cms.netlify.app

backend:
  name: github
  repo: walkthru-earth/opensensor-space
  branch: contributions-clean

# Point back to the main Evidence site
site_url: https://opensensor.space
display_url: https://opensensor.space

# Media files storage
media_folder: static/images/stations
public_folder: /images/stations

# Slug settings
slug:
  encoding: ascii
  clean_accents: true

# Collections
collections:
  # Station Registration
  - name: stations
    label: Sensor Stations
    label_singular: Station
    folder: content/stations
    create: true
    extension: md
    format: yaml-frontmatter
    slug: "{{fields.station_id}}"
    identifier_field: station_id
    summary: "{{station_name}} ({{sensor_type}}) - {{station_type}}"
    sortable_fields:
      fields:
        - station_name
        - sensor_type
        - station_type
        - submitted_at
    fields:
      - name: station_id
        label: Station ID (UUID)
        widget: uuid
        hint: "Auto-generated unique identifier for your station"

      - name: station_name
        label: Station Name
        widget: string
        pattern:
          - "^.{3,50}$"
          - "Station name must be 3-50 characters"
        hint: "A friendly name for your station (e.g., 'Cairo Indoor Monitor', 'Mobile Air Quality Tracker')"

      - name: sensor_type
        label: Sensor Type
        widget: select
        options:
          - label: "Enviro+ (Pimoroni)"
            value: enviroplus
          - label: "Custom Environmental"
            value: custom_environmental
          - label: "Industrial IoT"
            value: industrial
          - label: "Agricultural"
            value: agricultural
          - label: "Other"
            value: other
        default: enviroplus
        hint: "Select the type of sensor hardware you're using"

      - name: station_type
        label: Station Type
        widget: select
        options:
          - label: "Indoor"
            value: Indoor
          - label: "Outdoor"
            value: Outdoor
          - label: "Moving (Vehicle/Drone/Portable)"
            value: Moving
        default: Indoor
        hint: "Where is your sensor deployed?"

      - name: location
        label: Station Location
        widget: map
        type: Point
        decimals: 6
        hint: "Click on the map to set your station's location (or enter coordinates). For Moving stations, set the primary/home location."

      - name: storage_url
        label: Storage URL (S3 Path)
        widget: string
        pattern:
          - "^s3://[a-zA-Z0-9.-]+/.*$"
          - "Must be a valid S3 URL (s3://bucket-name/path/)"
        hint: "S3-compatible storage URL where your sensor data is stored (e.g., s3://us-west-2.opendata.source.coop/your-org/your-dataset/)"

      - name: description
        label: Description
        widget: text
        required: false
        hint: "Optional: Describe your station setup, sensors, or deployment context"

      - name: contributor_name
        label: Your Name / Organization
        widget: string
        required: false
        hint: "Optional: How would you like to be credited?"

      - name: contributor_url
        label: Website / Profile URL
        widget: string
        required: false
        pattern:
          - "^(https?://.*)?$"
          - "Must be a valid URL starting with http:// or https://"
        hint: "Optional: Link to your website or profile"

      - name: submitted_at
        label: Submission Date
        widget: datetime
        date_format: "YYYY-MM-DD"
        time_format: false
        format: "YYYY-MM-DD"
        default: "{{now}}"
        hint: "Date of station registration"

      - name: status
        label: Status
        widget: hidden
        default: pending
